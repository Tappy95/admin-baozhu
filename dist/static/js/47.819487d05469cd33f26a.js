webpackJsonp([47],{"K/bC":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("xT6B"),i=a("iPXC"),s={name:"RechargeChange",data:function(){return{pageTotal:"",count:"",pTime:!1,cTime:!1,exportExle:!1,dialogTable:!1,formLabelWidth:"120px",currentPage:1,pageSize:10,totalCount:0,formInline:{},tableData:[],message:{},labelWidth:"80px",selectTime:"",selectTimePay:"",subTotalPrice:"",totalPrice:"",pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},fullscreenLoading:!1,menuId:""}},created:function(){this.menuId=this.$route.query.id,this.queryBtns(),this.accountList()},filters:{currencyFixed:function(e){return parseInt(e).toFixed(2).replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")},dateFont:function(e){return Object(l.a)(new Date(e),"yyyy-MM-dd hh:mm:sss")}},methods:{indexMethod:function(e){return 1*e+1},dateFormat:function(e,t){var a=e[t.property];return void 0==a?"":Object(l.a)(new Date(a),"yyyy-MM-dd hh:mm:sss")},queryBtns:function(){var e=this,t={menuId:this.menuId};this.$fetch("/api/pMenuBtn/queryBtns",t).then(function(t){if((t.statusCode+"").startsWith("2"))for(var a=t.data.length-1;a>=0;a--)"exportExle"==t.data[a].btnCode&&(e.exportExle=!0)})},accountList:function(){var e=this,t={pageNum:this.currentPage,pageSize:this.pageSize,accountId:this.formInline.accountId,outTradeNo:this.formInline.outTradeNo,state:this.formInline.state,startTime:this.formInline.startTime,endTime:this.formInline.endTime,startPayTime:this.formInline.startPayTime,endPayTime:this.formInline.endPayTime,channelCode:this.formInline.channelCode};this.$fetch("/api/pay/page",t).then(function(t){(t.statusCode+"").startsWith("2")?(e.tableData=t.data.list,e.totalCount=t.data.total,e.subTotalPrice=t.data.subTotalPrice,e.totalPrice=t.data.totalPrice,e.pageTotal=t.data.pageTotal,e.count=t.data.count):e.$message({type:"error",message:t.message,duration:3e3})})},getInfo:function(e){var t=this;this.dialogTable=!0,this.$fetch("/api/pay/info",{id:e}).then(function(e){(e.statusCode+"").startsWith("2")&&(e.data.creatorTime=Object(l.a)(new Date(e.data.creatorTime),"yyyy-MM-dd hh:mm:sss"),e.data.payTime&&(e.data.payTime=Object(l.a)(new Date(e.data.payTime),"yyyy-MM-dd hh:mm:sss"),t.pTime=!0),e.data.cancelTime&&(e.data.cancelTime=Object(l.a)(new Date(e.data.cancelTime),"yyyy-MM-dd hh:mm:sss"),t.cTime=!0),e.data.payMode=parseInt(e.data.payMode),e.data.payType=parseInt(e.data.payType),t.message=e.data)})},search:function(){this.selectTime&&this.selectTime[0]?this.formInline.startTime=this.selectTime[0].getTime():this.formInline.startTime="",this.selectTime&&this.selectTime[1]?this.formInline.endTime=this.selectTime[1].getTime():this.formInline.endTime="",this.selectTimePay&&this.selectTimePay[0]?this.formInline.startPayTime=this.selectTimePay[0].getTime():this.formInline.startPayTime="",this.selectTimePay&&this.selectTimePay[1]?this.formInline.endPayTime=this.selectTimePay[1].getTime():this.formInline.endPayTime="",this.currentPage=1,this.pageSize=10,this.accountList()},queryExport:function(){this.fullscreenLoading=this.$loading({lock:!0,text:"正在导出...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.selectTime&&this.selectTime[0]?this.formInline.startTime=this.selectTime[0].getTime():this.formInline.startTime="",this.selectTime&&this.selectTime[1]?this.formInline.endTime=this.selectTime[1].getTime():this.formInline.endTime="",this.selectTimePay&&this.selectTimePay[0]?this.formInline.startPayTime=this.selectTimePay[0].getTime():this.formInline.startPayTime="",this.selectTimePay&&this.selectTimePay[1]?this.formInline.endPayTime=this.selectTimePay[1].getTime():this.formInline.endPayTime="";var e=this.formInline.accountId,t=this.formInline.outTradeNo,a={url:"/excl/payExcl",accountId:e,state:this.formInline.state,channelCode:this.formInline.channelCode,startTime:this.formInline.startTime,endTime:this.formInline.endTime,startPayTime:this.formInline.startPayTime,endPayTime:this.formInline.endPayTime,outTradeNo:t,token:Object(i.d)("token"),channel:Object(i.d)("channelCode"),relation:Object(i.d)("userRelation")};this.doDownload(a)},doDownload:function(e){var t=this,a=e.url,l=e.accountId,i=e.outTradeNo,s=e.state,n=e.channelCode,o=e.startTime,r=e.endTime,c=e.startPayTime,m=e.endPayTime,d=e.token,u=e.channel,p=e.relation,h=document.createElement("a"),f=a;f==a&&l&&(f=f+"?accountId="+l),f==a?s&&(f=f+"?state="+s):s&&(f=f+"&state="+s),f==a?n&&(f=f+"?channelCode="+n):n&&(f=f+"&channelCode="+n),f==a?i&&(f=f+"?outTradeNo="+i):i&&(f=f+"&outTradeNo="+i),f==a?o&&(f=f+"?startTime="+o):o&&(f=f+"&startTime="+o),f==a?r&&(f=f+"?endTime="+r):r&&(f=f+"&endTime="+r),f==a?c&&(f=f+"?startPayTime="+c):c&&(f=f+"&startPayTime="+c),f==a?m&&(f=f+"?endPayTime="+m):m&&(f=f+"&endPayTime="+m),f=f==a?f+"?token="+d+"&channel="+u+"&relation="+p:f+"&token="+d+"&channel="+u+"&relation="+p,h.setAttribute("href",f),document.querySelector("body").appendChild(h),h.click(),h.remove(),setTimeout(function(){t.fullscreenLoading.close()},5e3)},handleSizeChange:function(e){this.pageSize=e,this.accountList()},handleCurrentChange:function(e){this.currentPage=e,this.accountList()}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rechargr-change-wrap"},[a("div",{staticClass:"rechargr-change-inner"},[e._m(0),e._v(" "),a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"用户ID:"}},[a("el-input",{attrs:{placeholder:"请输入用户ID",clearable:""},model:{value:e.formInline.accountId,callback:function(t){e.$set(e.formInline,"accountId",t)},expression:"formInline.accountId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单号:"}},[a("el-input",{staticStyle:{width:"250px"},attrs:{placeholder:"请输入订单号",clearable:""},model:{value:e.formInline.outTradeNo,callback:function(t){e.$set(e.formInline,"outTradeNo",t)},expression:"formInline.outTradeNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道标识:"}},[a("el-input",{attrs:{placeholder:"请输入渠道标识",clearable:""},model:{value:e.formInline.channelCode,callback:function(t){e.$set(e.formInline,"channelCode",t)},expression:"formInline.channelCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.formInline.state,callback:function(t){e.$set(e.formInline,"state",t)},expression:"formInline.state"}},[a("el-option",{attrs:{label:"待支付",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已支付",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"已取消",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"全部",value:""}})],1)],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.labelWidth,label:"订单时间:"}},[a("el-date-picker",{attrs:{type:"datetimerange",align:"left","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.selectTime,callback:function(t){e.selectTime=t},expression:"selectTime"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.labelWidth,label:"支付时间:"}},[a("el-date-picker",{attrs:{type:"datetimerange",align:"left","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.selectTimePay,callback:function(t){e.selectTimePay=t},expression:"selectTimePay"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.search()}}},[e._v("查询")]),e._v(" "),e.exportExle?a("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){e.queryExport()}}},[e._v("导出表格")]):e._e()],1),e._v(" "),e._m(1)],1),e._v(" "),a("div",{staticClass:"rechargr-change-table"},[[a("el-table",{attrs:{data:e.tableData,height:"555","max-height":"518"}},[a("el-table-column",{attrs:{fixed:"left",label:"序号",type:"index",index:e.indexMethod,width:"80"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"200",fixed:"left",prop:"outTradeNo",label:"订单号"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120",fixed:"left",prop:"userName",label:"姓名"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120",fixed:"left",label:"用户id"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:e.formInline.accountId?e.amountyellow:""},[e._v(e._s(t.row.accountId))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"120",fixed:"left",prop:"userChannelCode",label:"渠道标识"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",prop:"purposeName",label:"购买类型"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",prop:"typeName",label:"支付类型"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",label:"订单金额(￥)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"amountyellow"},[e._v(e._s(t.row.price))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",label:"实际支付金额(￥)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"amountgreen"},[e._v(e._s(t.row.actualPrice))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",label:"折扣金额(￥)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"amountblue"},[e._v(e._s(t.row.discount))])]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"150",sortable:"",prop:"balance",label:"余额抵扣"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payTime",sortable:"",formatter:e.dateFormat,width:"170px",label:"支付时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.payTime>0?a("span",[e._v(e._s(e._f("dateFont")(t.row.payTime)))]):a("span",[e._v("-")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"creatorTime",sortable:"",formatter:e.dateFormat,width:"170px",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{"min-width":"100",prop:"state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.state?a("span",{staticClass:"amountblue"},[e._v("待支付")]):e._e(),e._v(" "),2==t.row.state?a("span",{staticClass:"amountgreen"},[e._v("已支付")]):e._e(),e._v(" "),3==t.row.state?a("span",{staticClass:"amountyellow"},[e._v("已取消")]):e._e()]}}])})],1)],e._v(" "),a("el-dialog",{attrs:{title:"详情",visible:e.dialogTable,width:"800px"},on:{"update:visible":function(t){e.dialogTable=t}}},[a("el-form",[a("el-row",[a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"真实姓名:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.userName,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"订单号:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.outTradeNo,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"订单金额:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.price,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"实际支付金额:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.actualPrice,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"折扣金额:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.price-e.message.actualPrice-e.message.balance,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"支付描述:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.descripte,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"支付方式","label-width":e.formLabelWidth}},[a("el-select",{attrs:{disabled:!0,placeholder:""},model:{value:e.message.payMode,callback:function(t){e.$set(e.message,"payMode",t)},expression:"message.payMode"}},[a("el-option",{attrs:{label:"支付宝",value:1}}),e._v(" "),a("el-option",{attrs:{label:"微信",value:2}}),e._v(" "),a("el-option",{attrs:{label:"余额",value:3}})],1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"支付类型","label-width":e.formLabelWidth}},[a("el-select",{attrs:{disabled:!0,placeholder:""},model:{value:e.message.payType,callback:function(t){e.$set(e.message,"payType",t)},expression:"message.payType"}},[a("el-option",{attrs:{label:"app",value:1}}),e._v(" "),a("el-option",{attrs:{label:"小程序",value:2}})],1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"状态","label-width":e.formLabelWidth}},[a("el-select",{attrs:{disabled:!0,placeholder:""},model:{value:e.message.state,callback:function(t){e.$set(e.message,"state",t)},expression:"message.state"}},[a("el-option",{attrs:{label:"待支付",value:1}}),e._v(" "),a("el-option",{attrs:{label:"已支付",value:2}}),e._v(" "),a("el-option",{attrs:{label:"已取消",value:3}})],1)],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"余额抵扣:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.balance,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"创建时间:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.creatorTime,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1),e._v(" "),e.pTime?a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"支付时间:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.payTime,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1):e._e(),e._v(" "),e.cTime?a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"取消时间:","label-width":e.formLabelWidth}},[a("el-input",{attrs:{value:e.message.cancelTime,disabled:!0,"auto-complete":"off",clearable:""}})],1)],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogTable=!1}}},[e._v("确 定")])],1)],1)],2),e._v(" "),1!=e.formInline.state&&3!=e.formInline.state?a("div",{staticClass:"sun_sty"},[a("p",[e._v("小计"),a("span",[e._v("("+e._s(e.pageTotal)+")：")]),e._v("[ 总入款金额："+e._s(e.subTotalPrice)+" ]")]),e._v(" "),a("p",[e._v("合计"),a("span",[e._v("("+e._s(e.count)+")：")]),e._v("[ 总入款金额："+e._s(e.totalPrice)+" ]")])]):e._e(),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,70],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"rechargr-change-header"},[t("h3",[this._v("财务流水/入款记录")]),this._v(" "),t("hr")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("p",{staticClass:"sun_sty"},[this._v("1元=10000金币=100000金猪")])])}]};var o=a("VU/8")(s,n,!1,function(e){a("fJSk")},null,null);t.default=o.exports},fJSk:function(e,t){}});