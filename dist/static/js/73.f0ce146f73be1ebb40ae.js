webpackJsonp([73],{"Oo/5":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("xT6B"),i={name:"GameList",data:function(){return{formLabelWidth:"120px",currentPage:1,pageSize:10,totalCount:0,formInline:{},tableData:[],message:{},menuId:"",del:!1,UpperShelf:!1,optionW:"0",showW:!1,upd:!1,tags:!1,gameList:[],lableList:[],dialogTableVisible:!1,dialogTableTags:!1,formtwo:{},currentId:"",checkList:"",dynamicTags:[],inputVisible:!1,inputValue:"",rules:{orderId:[{required:!0,message:"请输入排序",trigger:"blur"}]}}},created:function(){this.menuId=this.$route.query.id,this.queryBtns(),this.gameData(),this.accountList(),this.gameTags()},methods:{queryBtns:function(){var t=this,e={menuId:this.menuId};this.$fetch("/api/pMenuBtn/queryBtns",e).then(function(e){if((e.statusCode+"").startsWith("2"))for(var a=e.data.length-1;a>=0;a--)t.showW=!0,"del"==e.data[a].btnCode&&(t.del=!0),"tags"==e.data[a].btnCode&&(t.tags=!0),"UpperShelf"==e.data[a].btnCode&&(t.UpperShelf=!0),"upd"==e.data[a].btnCode&&(t.upd=!0),1==e.data.length?t.optionW="75":2==e.data.length?t.optionW="150":3==e.data.length?t.optionW="225":4==e.data.length&&(t.optionW="295");else t.showW=!1})},indexMethod:function(t){return 1*t+1},dateFormat:function(t,e){var a=t[e.property];return void 0==a?"":Object(s.a)(new Date(a),"yyyy-MM-dd hh:mm:sss")},gameData:function(){var t=this;this.$fetch("/api/tpInterface/listDown").then(function(e){(e.statusCode+"").startsWith("2")&&(t.gameList=e.data)})},handleClose:function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.dynamicTags.push(t),this.inputVisible=!1,this.inputValue=""},gameTags:function(){var t=this;this.$fetch("/api/tpGameType/optionList",{}).then(function(e){(e.statusCode+"").startsWith("2")&&(t.lableList=e.data)})},tagsTap:function(t){var e=this;this.checkList=[],this.currentId=t,this.dialogTableTags=!0,this.$fetch("/api/gameRelationType/listType",{gameId:t}).then(function(t){(t.statusCode+"").startsWith("2")&&(e.checkList=t.data)})},tagSet:function(){var t=this,e="";this.checkList&&(e=this.checkList.join(","));var a={gameId:this.currentId,labelIds:e};this.$post("/api/gameRelationType/update",a).then(function(e){(e.statusCode+"").startsWith("2")?(t.dialogTableTags=!1,t.accountList(),t.$message({type:"success",message:"设置标签成功"})):t.$message({type:"error",message:e.message})})},accountList:function(){var t=this,e={pageNum:this.currentPage,pageSize:this.pageSize,gameId:this.formInline.gameId,gameTitle:this.formInline.gameTitle,status:this.formInline.status,ptype:this.formInline.ptype,interfaceId:this.formInline.interfaceId,isSetType:this.formInline.isSetType};this.$fetch("/api/tpGame/queryBList",e).then(function(e){if((e.statusCode+"").startsWith("2")){for(var a=e.data.list.length-1;a>=0;a--)e.data.list[a].labelStr&&(e.data.list[a].labelStr=e.data.list[a].labelStr.split(","));t.tableData=e.data.list,t.totalCount=e.data.total}else t.$message({type:"error",message:e.message,duration:3e3})})},getStatus:function(t,e,a){var s=this,i=1==e?"上架":"下架";this.$confirm("此操作将"+i+"该游戏, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){var l={id:t,status:e};s.$post("/api/tpGame/modify",l).then(function(t){(t.statusCode+"").startsWith("2")?(s.$message({type:"success",message:a+"游戏"+i+"成功"}),s.accountList()):s.$message({type:"error",message:t.message,duration:3e3})})}).catch(function(){s.$message({type:"info",message:"已取消操作"})})},getInfo:function(t){var e=this;this.dynamicTags=[],this.currentId=t,this.$fetch("/api/tpGame/queryOne",{id:t}).then(function(t){(t.statusCode+"").startsWith("2")&&(e.dialogTableVisible=!0,e.formtwo=t.data,t.data.labelStr&&(e.dynamicTags=t.data.labelStr.split(",")))})},update:function(t){var e=this;if(!/^[0-9]*$/.test(this.formtwo.orderId))return this.$message({type:"warning",message:"排序值为正整数"}),!1;this.dynamicTags.length>=1&&(this.formtwo.labelStr=this.dynamicTags.join(",")),this.$refs[t].validate(function(t){t&&e.$post("/api/tpGame/modify",e.formtwo).then(function(t){(t.statusCode+"").startsWith("2")?(e.dialogTableVisible=!1,e.$message({type:"success",message:"修改成功！"}),e.accountList()):e.$message({type:"error",message:t.message})})})},Delete:function(t,e){var a=this;this.$confirm("此操作将永久删除"+e+"游戏, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){a.delData(t,e)}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},delData:function(t,e){var a=this;this.$fetch("/api/tpGame/remove",{id:t}).then(function(t){(t.statusCode+"").startsWith("2")&&(a.$message({type:"success",message:e+"游戏删除成功！"}),a.accountList())})},search:function(){this.currentPage=1,this.pageSize=10,this.accountList()},handleSizeChange:function(t){this.pageSize=t,this.accountList()},handleCurrentChange:function(t){this.currentPage=t,this.accountList()}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"game-list-wrap"},[a("div",{staticClass:"game-list-inner"},[t._m(0),t._v(" "),a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formInline}},[a("el-form-item",{attrs:{label:"游戏id:"}},[a("el-input",{attrs:{placeholder:"请输入游戏id",clearable:""},model:{value:t.formInline.gameId,callback:function(e){t.$set(t.formInline,"gameId",e)},expression:"formInline.gameId"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"游戏标题:"}},[a("el-input",{attrs:{placeholder:"请输入游戏标题",clearable:""},model:{value:t.formInline.gameTitle,callback:function(e){t.$set(t.formInline,"gameTitle",e)},expression:"formInline.gameTitle"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.formInline.status,callback:function(e){t.$set(t.formInline,"status",e)},expression:"formInline.status"}},[a("el-option",{attrs:{label:"正常",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"下架",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"全部",value:""}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"设备类型:"}},[a("el-select",{attrs:{placeholder:"请选择设备类型"},model:{value:t.formInline.ptype,callback:function(e){t.$set(t.formInline,"ptype",e)},expression:"formInline.ptype"}},[a("el-option",{attrs:{label:"ios",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"安卓",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"全部",value:""}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"是否设置类型:"}},[a("el-select",{attrs:{placeholder:"请选择是否设置类型"},model:{value:t.formInline.isSetType,callback:function(e){t.$set(t.formInline,"isSetType",e)},expression:"formInline.isSetType"}},[a("el-option",{attrs:{label:"是",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"否",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"全部",value:""}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"游戏方名称:"}},[a("el-select",{attrs:{placeholder:"请选择游戏方名称"},model:{value:t.formInline.interfaceId,callback:function(e){t.$set(t.formInline,"interfaceId",e)},expression:"formInline.interfaceId"}},[t._l(t.gameList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),t._v(" "),a("el-option",{attrs:{label:"全部",value:""}})],2)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){t.search()}}},[t._v("查询")])],1)],1)],1),t._v(" "),a("div",{staticClass:"game-list-table"},[[a("el-table",{attrs:{data:t.tableData,height:"556"}},[a("el-table-column",{attrs:{fixed:"left",label:"序号",type:"index",index:t.indexMethod,width:"80"}}),t._v(" "),a("el-table-column",{attrs:{width:"170px",fixed:"left",prop:"gameId",label:"游戏id"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150",prop:"gameTitle",label:"游戏标题"}}),t._v(" "),a("el-table-column",{attrs:{width:"200px",prop:"gameGold",label:"奖励金额(￥)"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"300",prop:"packageName",label:"游戏包名"}}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150",label:"任务标签"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.labelStr,function(e,s){return a("span",{staticClass:"span_label"},[t._v(t._s(e))])})}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"150",prop:"shortIntro",label:"充值高返"}}),t._v(" "),a("el-table-column",{attrs:{width:"150px",label:"设备类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.ptype?a("span",{staticClass:"onCZ"},[t._v("ios")]):t._e(),t._v(" "),2==e.row.ptype?a("span",{staticClass:"onCX"},[t._v("安卓")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150",prop:"orderId",label:"排序"}}),t._v(" "),a("el-table-column",{attrs:{width:"150px",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.status?a("span",{staticClass:"onCZ"},[t._v("正常")]):t._e(),t._v(" "),2==e.row.status?a("span",{staticClass:"onCX"},[t._v("下架")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"150",prop:"gameLabelName",label:"游戏类型"}}),t._v(" "),t.showW?a("el-table-column",{attrs:{fixed:"right",prop:"status",label:"操作",width:t.optionW},scopedSlots:t._u([{key:"default",fn:function(e){return[t.del?a("el-button",{attrs:{type:"warning",plain:"",size:"mini"},on:{click:function(a){t.Delete(e.row.id,e.row.gameTitle)}}},[t._v("删除")]):t._e(),t._v(" "),1==e.row.status&&t.UpperShelf?a("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(a){t.getStatus(e.row.id,2,e.row.gameTitle)}}},[t._v("下架")]):t._e(),t._v(" "),2==e.row.status&&t.UpperShelf?a("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(a){t.getStatus(e.row.id,1,e.row.gameTitle)}}},[t._v("上架")]):t._e(),t._v(" "),t.upd?a("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(a){t.getInfo(e.row.id)}}},[t._v("修改")]):t._e(),t._v(" "),t.tags?a("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(a){t.tagsTap(e.row.id)}}},[t._v("类型")]):t._e()]}}])}):t._e()],1)]],2),t._v(" "),a("el-dialog",{attrs:{title:"设置类型",visible:t.dialogTableTags,width:"700px"},on:{"update:visible":function(e){t.dialogTableTags=e}}},[a("el-row",[a("el-checkbox-group",{attrs:{"text-color":"#1fa67a",fill:"#1fa67a"},model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},t._l(t.lableList,function(e){return a("el-checkbox",{key:e.index,staticStyle:{"margin-bottom":"10px"},attrs:{label:e.id}},[t._v(t._s(e.typeName))])}))],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.tagSet()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改",visible:t.dialogTableVisible,width:"800px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-form",{ref:"formtwo",attrs:{model:t.formtwo,rules:t.rules}},[a("el-row",[a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"游戏标题:","label-width":t.formLabelWidth}},[a("el-input",{attrs:{readonly:!0,"auto-complete":"off",clearable:""},model:{value:t.formtwo.gameTitle,callback:function(e){t.$set(t.formtwo,"gameTitle",t._n(e))},expression:"formtwo.gameTitle"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:22}},[a("el-form-item",{attrs:{label:"充值高返:",prop:"shortIntro","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:t.formtwo.shortIntro,callback:function(e){t.$set(t.formtwo,"shortIntro",e)},expression:"formtwo.shortIntro"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"排序:",prop:"orderId","label-width":t.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:t.formtwo.orderId,callback:function(e){t.$set(t.formtwo,"orderId",e)},expression:"formtwo.orderId"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",[a("span",{staticClass:"xu-tip"},[t._v("排序值越大,游戏越靠前")])])],1),t._v(" "),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"任务标签:",prop:"shortIntro","label-width":t.formLabelWidth}},[t._l(t.dynamicTags,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n              "+t._s(e)+"\n            ")])}),t._v(" "),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):t._e(),t._v(" "),t.dynamicTags.length<2?a("el-button",{directives:[{name:"else",rawName:"v-else"}],staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")]):t._e()],2)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.update("formtwo")}}},[t._v("确 定")])],1)],1),t._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,50,70],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalCount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"game-list-header"},[e("h3",[this._v("第三方/游戏列表")]),this._v(" "),e("hr")])}]};var n=a("VU/8")(i,l,!1,function(t){a("Y5wL")},null,null);e.default=n.exports},Y5wL:function(t,e){}});