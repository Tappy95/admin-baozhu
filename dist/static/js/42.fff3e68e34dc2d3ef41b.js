webpackJsonp([42],{"5GW8":function(e,t){},"8h9c":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("xT6B"),o={name:"PunchAwardRules",data:function(){var e=this;return{styleObject:{width:"200px"},powerTrue:!1,optionW:"0",menuId:"",add:!1,del:!1,upd:!1,dialogTableVisibleInfo:!1,formtwoInfo:{},dialogTableVisible:!1,formtwo:{},dialogFormVisible:!1,form:{minNumber:"",maxNumber:"",rewardRatio:"",extraReward:"",minReward:"",maxReward:""},rules:{minNumber:[{required:!0,message:"请输入参与打卡最少人数",trigger:"blur"},{validator:function(t,r,a){e.$patternNum1.test(r)?a():a(new Error("请输入正整数"))},trigger:"blur"}],maxNumber:[{required:!0,message:"请输入参与打卡最多人数",trigger:"blur"},{validator:function(t,r,a){e.$patternNum1.test(r)?a():a(new Error("请输入正整数"))},trigger:"blur"}],rewardRatio:[{required:!0,message:"请输入奖励比例",trigger:"blur"},{validator:function(t,r,a){e.$patternNum2.test(r)?a():a(new Error("请输入正数"))},trigger:"blur"}],extraReward:[{required:!0,message:"请输入额外奖励",trigger:"blur"},{validator:function(t,r,a){e.$patternNum1.test(r)?a():a(new Error("请输入正整数"))},trigger:"blur"}],minReward:[{required:!0,message:"请输入最小奖励",trigger:"blur"},{validator:function(t,r,a){e.$patternNum1.test(r)?a():a(new Error("请输入正整数"))},trigger:"blur"}],maxReward:[{required:!0,message:"请输入最大奖励",trigger:"blur"},{validator:function(t,r,a){e.$patternNum1.test(r)?a():a(new Error("请输入正整数"))},trigger:"blur"}]},formLabelWidth:"160px",formInline:{},tableData:[],isSubmit:!1}},created:function(){this.menuId=this.$route.query.id,this.queryBtns(),this.accountList()},filters:{dateFont:function(e){return Object(a.a)(new Date(e),"yyyy-MM-dd hh:mm:sss")},currency:function(e){return parseInt(e).toFixed(0).replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,")}},methods:{queryBtns:function(){var e=this,t={menuId:this.menuId};this.$fetch("/api/pMenuBtn/queryBtns",t).then(function(t){if((t.statusCode+"").startsWith("2"))for(var r=t.data.length-1;r>=0;r--)"add"==t.data[r].btnCode&&(e.add=!0),"upd"==t.data[r].btnCode&&(e.upd=!0,e.powerTrue=!0,e.optionW="75"),"del"==t.data[r].btnCode&&(e.del=!0,e.powerTrue=!0,e.optionW="75"),e.upd&&e.del&&(e.powerTrue=!0,e.optionW="160")})},indexMethod:function(e){return 1*e+1},dateFormat:function(e,t){var r=e[t.property];return void 0==r?"":Object(a.a)(new Date(r),"yyyy-MM-dd hh:mm:sss")},accountList:function(){var e=this;this.$fetch("/api/checkinRewardRule/list").then(function(t){(t.statusCode+"").startsWith("2")?e.tableData=t.data.list:e.$message({type:"error",message:t.message,duration:3e3})})},load:function(){this.form={},this.dialogFormVisible=!0,this.isSubmit=!1},addBtn:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(parseInt(t.form.minNumber)>parseInt(t.form.maxNumber))return void t.$message({type:"warning",message:"参与打卡最多人数不得小于最少人数！"});if(parseInt(t.form.minReward)>parseInt(t.form.maxReward))return void t.$message({type:"warning",message:"最大奖励不得小于最小奖励！"});t.$nextTick(function(){this.isSubmit=!0}),t.form.pushTime=new Date(t.form.pushTime).getTime(),t.$post("/api/checkinRewardRule/add",t.form).then(function(e){(e.statusCode+"").startsWith("2")?(t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功！"}),t.accountList()):(t.$message({type:"error",message:e.message}),t.isSubmit=!0)})}})},Delete:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){t.delData(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},delData:function(e){var t=this,r={id:e};this.$fetch("/api/checkinRewardRule/delete",r).then(function(e){(e.statusCode+"").startsWith("2")?(t.$message({type:"success",message:"删除成功！"}),t.accountList()):t.$message({type:"error",message:"删除失败！"})})},getInfo:function(e){var t=this;this.dialogTableVisible=!0,this.$fetch("/api/checkinRewardRule/info",{id:e}).then(function(e){(e.statusCode+"").startsWith("2")&&(t.formtwo=e.data)})},update:function(e){var t=this;this.$refs[e].validate(function(e){if(e){if(parseInt(t.formtwo.minNumber)>parseInt(t.formtwo.maxNumber))return void t.$message({type:"warning",message:"参与打卡最多人数不得小于最少人数！"});if(parseInt(t.formtwo.minReward)>parseInt(t.formtwo.maxReward))return void t.$message({type:"warning",message:"最大奖励不得小于最小奖励！"});t.$put("/api/checkinRewardRule/update",t.formtwo).then(function(e){(e.statusCode+"").startsWith("2")?(t.$message({type:"success",message:"修改成功！"}),t.dialogTableVisible=!1,t.accountList()):t.$message({type:"error",message:e.message})})}})}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"punch-award-wrap"},[r("div",{staticClass:"punch-award-inner"},[e._m(0),e._v(" "),r("div",[r("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[r("el-form-item",{attrs:{label:""}},[e.add?r("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){e.load()}}},[e._v("添加")]):e._e()],1)],1)],1),e._v(" "),r("div",{staticClass:"punch-award-table"},[[r("el-table",{attrs:{data:e.tableData,"max-height":"600"}},[r("el-table-column",{attrs:{fixed:"left",label:"序号",type:"index",index:e.indexMethod,width:"80"}}),e._v(" "),r("el-table-column",{attrs:{"min-width":"200px",prop:"minNumber",label:"参与打卡最小人数"}}),e._v(" "),r("el-table-column",{attrs:{prop:"maxNumber","min-width":"200px",label:"参与打卡最多人数"}}),e._v(" "),r("el-table-column",{attrs:{"min-width":"150px",prop:"minReward",label:"最小奖励(金币)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("currency")(t.row.minReward)))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"maxReward","min-width":"150px",label:"最大奖励(金币)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("currency")(t.row.maxReward)))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"rewardRatio","min-width":"120px",label:"奖励比例(%)"}}),e._v(" "),r("el-table-column",{attrs:{prop:"extraReward","min-width":"120px",label:"额外奖励(金币)"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("currency")(t.row.extraReward)))]}}])}),e._v(" "),e.powerTrue?r("el-table-column",{attrs:{fixed:"right",label:"操作",width:e.optionW},scopedSlots:e._u([{key:"default",fn:function(t){return[e.del?r("el-button",{attrs:{type:"warning",plain:"",size:"mini"},on:{click:function(r){e.Delete(t.row.id)}}},[e._v("删除")]):e._e(),e._v(" "),e.upd?r("el-button",{attrs:{type:"success",plain:"",size:"mini"},on:{click:function(r){e.getInfo(t.row.id)}}},[e._v("修改")]):e._e()]}}])}):e._e()],1)],e._v(" "),r("el-dialog",{attrs:{title:"添加",visible:e.dialogFormVisible,width:"650px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"参与打卡最少人数:","label-width":e.formLabelWidth,prop:"minNumber"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.minNumber,callback:function(t){e.$set(e.form,"minNumber",t)},expression:"form.minNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"参与打卡最多人数:","label-width":e.formLabelWidth,prop:"maxNumber"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.maxNumber,callback:function(t){e.$set(e.form,"maxNumber",t)},expression:"form.maxNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"最小奖励(金币):","label-width":e.formLabelWidth,prop:"minReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.minReward,callback:function(t){e.$set(e.form,"minReward",t)},expression:"form.minReward"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"最大奖励(金币):","label-width":e.formLabelWidth,prop:"maxReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.maxReward,callback:function(t){e.$set(e.form,"maxReward",t)},expression:"form.maxReward"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{label:"奖励比例(%):","label-width":e.formLabelWidth,prop:"rewardRatio"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.rewardRatio,callback:function(t){e.$set(e.form,"rewardRatio",t)},expression:"form.rewardRatio"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{label:"额外奖励(金币):","label-width":e.formLabelWidth,prop:"extraReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.form.extraReward,callback:function(t){e.$set(e.form,"extraReward",t)},expression:"form.extraReward"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary",disabled:e.isSubmit},on:{click:function(t){e.addBtn("form")}}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改",visible:e.dialogTableVisible,width:"650px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[r("el-form",{ref:"formtwo",attrs:{model:e.formtwo,rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"参与打卡最少人数:","label-width":e.formLabelWidth,prop:"minNumber"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.minNumber,callback:function(t){e.$set(e.formtwo,"minNumber",t)},expression:"formtwo.minNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"参与打卡最多人数:","label-width":e.formLabelWidth,prop:"maxNumber"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.maxNumber,callback:function(t){e.$set(e.formtwo,"maxNumber",t)},expression:"formtwo.maxNumber"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"最小奖励(金币):","label-width":e.formLabelWidth,prop:"minReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.minReward,callback:function(t){e.$set(e.formtwo,"minReward",t)},expression:"formtwo.minReward"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"最大奖励(金币):","label-width":e.formLabelWidth,prop:"maxReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.maxReward,callback:function(t){e.$set(e.formtwo,"maxReward",t)},expression:"formtwo.maxReward"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{label:"奖励比例(%):","label-width":e.formLabelWidth,prop:"rewardRatio"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.rewardRatio,callback:function(t){e.$set(e.formtwo,"rewardRatio",t)},expression:"formtwo.rewardRatio"}})],1)],1),e._v(" "),r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{label:"额外奖励(金币):","label-width":e.formLabelWidth,prop:"extraReward"}},[r("el-input",{attrs:{"auto-complete":"off",clearable:""},model:{value:e.formtwo.extraReward,callback:function(t){e.$set(e.formtwo,"extraReward",t)},expression:"formtwo.extraReward"}})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.update("formtwo")}}},[e._v("确 定")])],1)],1)],2)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"punch-award-header"},[t("h3",[this._v("早起打卡/奖励规则")]),this._v(" "),t("hr")])}]};var l=r("VU/8")(o,i,!1,function(e){r("5GW8")},null,null);t.default=l.exports}});